---
import type { CollectionEntry } from "astro:content";
import WorkLayout from "@/layouts/WorkLayout.astro";
import { getCollectionStaticPaths } from "@/lib/collection-helpers";

export interface Props {
    data: CollectionEntry<"works">;
}

export async function getStaticPaths() {
    return await getCollectionStaticPaths("works", "en");
}

const { data: work } = Astro.props;
const { Content } = await work.render();

const response = await fetch('https://raw.githubusercontent.com/quazar-vpn/routing/refs/heads/main/RU.DEEPLINK');
const redirectUrl = await response.text();
---

<script define:vars={{redirectUrl}}>
    // Auto-redirect to the happ:// URL
    document.addEventListener('DOMContentLoaded', () => {
        // Attempt to redirect
        window.location.href = redirectUrl;
    });
</script>